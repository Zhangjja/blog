(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{720:function(e,t,a){"use strict";a.d(t,"j",function(){return i}),a.d(t,"h",function(){return s}),a.d(t,"f",function(){return c}),a.d(t,"d",function(){return l}),a.d(t,"e",function(){return u}),a.d(t,"g",function(){return d}),a.d(t,"b",function(){return m}),a.d(t,"c",function(){return f}),a.d(t,"i",function(){return p}),a.d(t,"a",function(){return g});var n=a(84),o=a.n(n),r=(a(733),a(237)),i=function(e){return e?o()(e).format("YYYY-MM-DD HH:mm:ss"):null},s=function(e){return e?o()(e).format("YYYY-MM-DD"):null};function c(e){if(e){return Object(r.c)()+"/"+(e instanceof Array?e[0]||{}:e||{}).photo_url}return""}function l(e){return Object.keys(e).reduce(function(t,a){return"undefined"!==typeof e[a]&&(t[a]=e[a]),t},{})}function u(){return o()(Date.now())}function d(){return Date.now()+Math.random()}function m(e){return 1===e.split(",").length&&(e="data:image/jpg;base64,".concat(e)),e}var f=30,p={showSizeChanger:!0,showQuickJumper:!0,defaultPageSize:f},g=/(?=(\b|\D))(((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))\.){3}((\d{1,2})|(1\d{1,2})|(2[0-4]\d)|(25[0-5]))(?=(\b|\D))/},721:function(e,t,a){"use strict";t.a={userName:30,deviceName:50,deviceToken:50,IP:15,port:5,devicePosition:100,accountName:30,organization:50,mark:50,versionNumber:20,description:50,versionName:20,idcardNumber:30}},722:function(e,t,a){"use strict";var n=a(137),o=a(0),r=a.n(o),i=a(43),s=a(714),c=a(727),l=a.n(c);t.a=function(e){var t=e.title,a=e.Title,o=e.buttonText,c=e.doAction,u=e.buttonDisabled,d=e.buttonHide,m=e.hasDivider,f=e.customButton,p=e.buttonType,g=Object(n.a)(e,["title","Title","buttonText","doAction","buttonDisabled","buttonHide","hasDivider","customButton","buttonType"]),b=p||"primary",h=f&&r.a.createElement("div",null,f)||r.a.createElement(i.a,{type:b,onClick:c,disabled:u},o);return r.a.createElement("div",Object.assign({style:{marginBottom:5}},g),r.a.createElement("header",{className:l.a.total_header},r.a.createElement("div",null,a?r.a.createElement(a,null):t),!d&&h),m&&r.a.createElement(s.a,{className:l.a.mbt10_5}))}},724:function(e,t,a){"use strict";var n=a(121),o=a(30),r=a(31),i=a(34),s=a(32),c=a(33),l=a(0),u=a.n(l),d=a(765),m=a(718),f=a(868),p=a(9),g=a(19),b=a(105),h=(d.a.Option,Object(p.d)({all:{id:"common.all",defaultMessage:"\u5168\u90e8"},failedToGetData:{id:"common.error.failedToGetData",defaultMessage:"\u83b7\u53d6\u6570\u636e\u5931\u8d25!"},select:{id:"common.select",defaultMessage:"\u8bf7\u9009\u62e9"}})),v=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).loadSubAccounts=function(e){var t=e[e.length-1],o=t.account_id;t.loading=!0,a.getAccountList(o).then(function(e){t.loading=!1;var o=e.accounts;o=o.map(function(e){return e}),t.children=o,a.setState({acountOptions:Object(n.a)(a.state.acountOptions)})})},a.triggerChange=function(e,t){var n=a.props.onChange;n&&n(e,t)},a.initCascaderOptions=function(e){var t=Object(g.a)("userInfo",!0)||{},n={account_name:t.account_name,account_id:t.account_id,isLeaf:3===t.role.role_id,children:[]};a.getAccountList().then(function(e){var t=e.accounts||[];t=t.map(function(e){return e.isLeaf=3===e.role.role_id,3===a.props.value.length&&e.account_id===a.props.value[1]&&a.getAccountList(e.account_id).then(function(t){e.children=t.accounts.map(function(e){return e.isLeaf=!0,e}),a.setState({acountOptions:[n]})}),e}),n.children=t,a.setState({acountOptions:[n]})}).catch(function(e){m.a.error(e)})},a.state={acountOptions:[]},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=(Object(g.a)("userInfo",!0)||{}).account_id;this.initCascaderOptions(e)}},{key:"getAccountList",value:function(e){var t=this,a={account_id:e,page_size:99999};return new Promise(function(e,n){Object(b.f)(a).then(function(a){1e3===a.code?e(a.data):n(a.msg||t.props.intl.formatMessage(h.failedToGetData))})})}},{key:"render",value:function(){return u.a.createElement(f.a,{value:this.props.value||[],options:this.state.acountOptions,style:this.props.style,onChange:this.triggerChange,loadData:this.loadSubAccounts,changeOnSelect:!0,placeholder:this.props.intl.formatMessage(h.select),fieldNames:{label:"account_name",value:"account_id",children:"children"}})}}]),t}(u.a.Component);t.a=Object(p.e)(v)},725:function(e,t,a){"use strict";var n=a(30),o=a(31),r=a(34),i=a(32),s=a(33),c=a(37),l=a(0),u=a.n(l),d=a(749),m=a(858),f=a(9),p=a(728),g=a.n(p);function b(e){var t=[];return e.forEach(function(e){e.needTotal&&t.push(Object(c.a)({},e,{total:0}))}),t}var h=Object(f.d)({total:{id:"common.total",defaultMessage:"\u603b\u8ba1"},clear:{id:"common.clear",defaultMessage:"\u6e05\u7a7a"},selected:{id:"common.selected",defaultMessage:"\u8bf7\u9009\u62e9"},items:{id:"common.items",defaultMessage:"\u9879"}}),v=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).handleRowSelectChange=function(e,t){var n=a.state.needTotalList;n=n.map(function(e){return Object(c.a)({},e,{total:t.reduce(function(t,a){return t+parseFloat(a[e.dataIndex],10)},0)})});var o=a.props.onSelectRow;o&&o(t),a.setState({selectedRowKeys:e,needTotalList:n})},a.handleTableChange=function(e,t,n){var o=a.props.onChange;o&&o(e,t,n)},a.cleanSelectedKeys=function(){a.handleRowSelectChange([],[])};var o=b(e.columns);return a.state={selectedRowKeys:[],needTotalList:o},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,n=t.needTotalList,o=this.props,r=o.dataList,i=o.pagination,s=o.loading,p=o.columns,b=o.rowKey,v=o.selectable,_=o.showAlert,y=Object(c.a)({showSizeChanger:!0,showQuickJumper:!0,showTotal:function(t){return"".concat(e.props.intl.formatMessage(h.total)," ").concat(t," ").concat(e.props.intl.formatMessage(h.items))}},i),E={selectedRowKeys:a,onChange:this.handleRowSelectChange,getCheckboxProps:function(e){return{disabled:e.disabled}}};return u.a.createElement("div",{className:g.a.standardTable},v&&_&&u.a.createElement("div",{className:g.a.tableAlert},u.a.createElement(d.a,{message:u.a.createElement(l.Fragment,null,u.a.createElement(f.a,h.selected)," ",u.a.createElement("a",{style:{fontWeight:600}},a.length)," ",u.a.createElement(f.a,h.items),"\xa0\xa0",n.map(function(e){return u.a.createElement("span",{style:{marginLeft:8},key:e.dataIndex},e.title,u.a.createElement(f.a,h.total),"\xa0",u.a.createElement("span",{style:{fontWeight:600}},e.render?e.render(e.total):e.total))}),u.a.createElement("a",{onClick:this.cleanSelectedKeys,style:{marginLeft:24}},u.a.createElement(f.a,h.clear))),type:"info",showIcon:!0})),u.a.createElement(m.a,{loading:s,rowKey:b||"key",rowSelection:v?E:null,dataSource:r,columns:p,pagination:y,onChange:this.handleTableChange}))}}],[{key:"getDerivedStateFromProps",value:function(e){return 0===(e.selectedRows||[]).length?{selectedRowKeys:[],needTotalList:b(e.columns)}:null}}]),t}(l.PureComponent);v.defaultProps={selectable:!0,showAlert:!0},t.a=Object(f.e)(v)},726:function(e,t,a){"use strict";var n=a(30),o=a(31),r=a(34),i=a(32),s=a(33),c=a(0),l=a.n(c),u=a(9),d=a(711),m=a(734),f=(a(735),a(729)),p=a.n(f),g=Object(u.d)({loadFail:{id:"component.ImageViewer.loadFail",defaultMessage:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25!"}}),b={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},h=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).state={photoIndex:0},a}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOpen,a=e.imageUrl,n=e.onClose,o=e.isLoading,r=e.imagePadding;return l.a.createElement("div",null,t&&l.a.createElement("div",null,a&&!o&&l.a.createElement(m.a,{mainSrc:a,onCloseRequest:n,enableZoom:!1,imageLoadErrorMessage:l.a.createElement(u.a,g.loadFail),wrapperClassName:p.a.imageViewer,imagePadding:r,imageTitle:""}),o&&l.a.createElement(d.a,{style:b})))}}]),t}(c.Component);h.defaultProps={imagePadding:100},t.a=Object(u.e)(h)},727:function(e,t,a){e.exports={mbt10_5:"ListHeader_mbt10_5__3iesS",total_header:"ListHeader_total_header__itbu3"}},728:function(e,t,a){e.exports={standardTable:"StandardTable_standardTable__37lgC",tableAlert:"StandardTable_tableAlert__3mUk-"}},729:function(e,t,a){e.exports={imageViewer:"ImageViewer_imageViewer__1C2gj"}},732:function(e,t,a){"use strict";function n(e){return Object.keys(e).reduce(function(t,a){return"data-"!==a.substr(0,5)&&"aria-"!==a.substr(0,5)&&"role"!==a||"data-__"===a.substr(0,7)||(t[a]=e[a]),t},{})}a.d(t,"a",function(){return n})},748:function(e,t,a){"use strict";a.d(t,"e",function(){return i}),a.d(t,"a",function(){return s}),a.d(t,"j",function(){return c}),a.d(t,"c",function(){return l}),a.d(t,"d",function(){return u}),a.d(t,"f",function(){return d}),a.d(t,"b",function(){return m}),a.d(t,"h",function(){return f}),a.d(t,"i",function(){return p}),a.d(t,"g",function(){return g});var n=a(37),o=a(51),r={list:"/api/equipment/list",equipment:"/api/equipment",openDoor:"/api/equipment/open",closeDoor:"/api/equipment/close",resetPwd:"/api/equipment/reset",sync:"/api/equipment/synchronization",preview:"/api/equipment/preview"};function i(e){return o.b.get(r.list,{params:Object(n.a)({},e)})}function s(e){return o.b.post(r.equipment,e)}function c(e){return o.b.put(r.equipment,e)}function l(e){return o.b.delete(r.equipment,{data:{equipment_id:e}})}function u(e){return o.b.get(r.equipment,{params:{equipment_id:e}})}function d(e){return o.b.post(r.openDoor,{equipment_id:e})}function m(e){return o.b.post(r.closeDoor,{equipment_id:e})}function f(e){return o.b.post(r.resetPwd,{equipment_id:e})}function p(e){return o.b.post(r.sync,{equipment_id:e})}function g(e){return o.b.get(r.preview,{params:{equipment_id:e}})}},749:function(e,t,a){"use strict";a.d(t,"a",function(){return _});var n=a(0),o=a(5),r=a(38),i=a(11),s=a(4),c=a.n(s),l=a(10),u=a(732);function d(e){return(d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(){}var _=function(e){function t(){var e,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,s=g(t).apply(this,arguments),(e=!s||"object"!==d(s)&&"function"!==typeof s?b(a):s).state={closing:!0,closed:!1},e.handleClose=function(t){t.preventDefault();var a=o.findDOMNode(b(e));a.style.height="".concat(a.offsetHeight,"px"),a.style.height="".concat(a.offsetHeight,"px"),e.setState({closing:!1}),(e.props.onClose||v)(t)},e.animationEnd=function(){e.setState({closed:!0,closing:!0}),(e.props.afterClose||v)()},e.renderAlert=function(t){var a,o,s=t.getPrefixCls,l=e.props,d=l.description,p=l.prefixCls,g=l.message,b=l.closeText,h=l.banner,v=l.className,_=void 0===v?"":v,y=l.style,E=l.icon,O=e.props,w=O.closable,j=O.type,S=O.showIcon,M=O.iconType,C=s("alert",p);S=!(!h||void 0!==S)||S,j=h&&void 0===j?"warning":j||"info";var k="filled";if(!M){switch(j){case"success":M="check-circle";break;case"info":M="info-circle";break;case"error":M="close-circle";break;case"warning":M="exclamation-circle";break;default:M="default"}d&&(k="outlined")}b&&(w=!0);var D=c()(C,"".concat(C,"-").concat(j),(f(a={},"".concat(C,"-close"),!e.state.closing),f(a,"".concat(C,"-with-description"),!!d),f(a,"".concat(C,"-no-icon"),!S),f(a,"".concat(C,"-banner"),!!h),f(a,"".concat(C,"-closable"),w),a),_),L=w?n.createElement("a",{onClick:e.handleClose,className:"".concat(C,"-close-icon")},b||n.createElement(i.a,{type:"close"})):null,N=Object(u.a)(e.props),T=E&&(n.isValidElement(E)?n.cloneElement(E,{className:c()((o={},f(o,E.props.className,E.props.className),f(o,"".concat(C,"-icon"),!0),o))}):n.createElement("span",{className:"".concat(C,"-icon")},E))||n.createElement(i.a,{className:"".concat(C,"-icon"),type:M,theme:k});return e.state.closed?null:n.createElement(r.a,{component:"",showProp:"data-show",transitionName:"".concat(C,"-slide-up"),onEnd:e.animationEnd},n.createElement("div",m({"data-show":e.state.closing,className:D,style:y},N),S?T:null,n.createElement("span",{className:"".concat(C,"-message")},g),n.createElement("span",{className:"".concat(C,"-description")},d),L))},e}var a,s,_;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,n["Component"]),a=t,(s=[{key:"render",value:function(){return n.createElement(l.a,null,this.renderAlert)}}])&&p(a.prototype,s),_&&p(a,_),t}()},764:function(e,t,a){e.exports={tableList:"SystemManage_tableList__kWbWg",tableListOperator:"SystemManage_tableListOperator__3Fn0H",tableListForm:"SystemManage_tableListForm__tiJbV",submitButtons:"SystemManage_submitButtons__MuHUb",operatorLink:"SystemManage_operatorLink__1VKPR",operatorWrap:"SystemManage_operatorWrap__1ZAg5",wordBreak:"SystemManage_wordBreak__7SZVk"}},865:function(e,t,a){"use strict";a.r(t);var n=a(37),o=a(236),r=a(30),i=a(31),s=a(34),c=a(32),l=a(33),u=a(0),d=a.n(u),m=a(716),f=a(765),p=a(857),g=a(718),b=a(867),h=a(9),v=a(725),_=(a(726),a(722)),y=a(767),E=a(712),O=a(43),w=a(717),j=a(858),S=a(724),M=a(51),C=a(748),k={list:"/api/system/versionList",version:"/api/system/version",update:"/api/system/versionUpdate"};function D(e){var t=N(new FormData,e);return M.b.post(k.version,t)}function L(e){var t=N(new FormData,e);return M.b.put(k.version,t)}function N(e,t){return Object.keys(t).forEach(function(a){e.append(a,t[a])}),e}var T=a(19),R=a(721),I=a(764),A=a.n(I),q=m.a.Item,x=(f.a.Option,Object(h.d)({total:{id:"common.total",defaultMessage:"\u603b\u8ba1"},update:{id:"common.update",defaultMessage:"\u66f4\u65b0"},updateSuccess:{id:"common.update.success",defaultMessage:"\u66f4\u65b0\u6210\u529f!"},updateError:{id:"common.update.error",defaultMessage:"\u66f4\u65b0\u5931\u8d25\u4e86!"},items:{id:"common.items",defaultMessage:"\u9879"},search:{id:"common.search",defaultMessage:"\u67e5\u8be2"},reset:{id:"common.reset",defaultMessage:"\u91cd\u7f6e"},failedToGetData:{id:"common.error.failedToGetData",defaultMessage:"\u83b7\u53d6\u6570\u636e\u5931\u8d25!"},deviceList:{id:"device.deviceList",defaultMessage:"\u8bbe\u5907\u5217\u8868"},deviceName:{id:"device.deviceName",defaultMessage:"\u8bbe\u5907\u540d\u79f0"},deviceID:{id:"device.deviceID",defaultMessage:"\u8bbe\u5907ID"},connectStatus:{id:"device.connectStatus",defaultMessage:"\u8fde\u63a5\u72b6\u6001"},sourceAccount:{id:"account.sourceAccount",defaultMessage:"\u6240\u5c5e\u8d26\u6237"},all:{id:"common.all",defaultMessage:"\u5168\u90e8"},online:{id:"common.online",defaultMessage:"\u5728\u7ebf"},offline:{id:"common.offline",defaultMessage:"\u79bb\u7ebf"},sysVersion:{id:"device.sysVersion",defaultMessage:"\u7cfb\u7d71\u7248\u672c"},selectedRowRequired:{id:"common.selectedRow.required",defaultMessage:"\u8bf7\u5148\u9009\u62e9\u8981\u64cd\u4f5c\u7684\u6570\u636e!"}})),F=function(e){function t(){var e,a;Object(r.a)(this,t);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={loading:!1,locked:!1,dataList:[],search_form:{account_id:a.accountId||""},total:0,page_number:1,page_size:10,selectedRows:[]},a.columns=[{title:d.a.createElement(h.a,x.deviceName),dataIndex:"equipment_name",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:A.a.wordBreak},e))},width:150},{title:d.a.createElement(h.a,x.deviceID),dataIndex:"equipment_id",width:100},{title:d.a.createElement(h.a,x.sysVersion),dataIndex:"sysVersion",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:A.a.wordBreak},e))},width:150},{title:d.a.createElement(h.a,x.connectStatus),dataIndex:"status",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement(y.a,{status:["success","error"][e-1]}),[d.a.createElement(h.a,x.online),d.a.createElement(h.a,x.offline)][e-1])},width:100},{title:d.a.createElement(h.a,x.sourceAccount),dataIndex:"account_name",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:A.a.wordBreak},e))},width:150}],a.onAccountChange=function(e){a.props.form.setFieldsValue({account_id:e[e.length-1]})},a.getInitAccountIds=function(){var e=Object(T.a)("userInfo",!0),t=e.role,n=[e.account_id];return 1===t&&a.accountId&&(a.parentId&&n.push(Number(a.parentId)),n.push(a.accountId)),n},a._loadAsyncData=function(){if(a.props.id){a.setState({loading:!0});var e=[],t=a.state,o=t.page_number,r=t.page_size,i=t.search_form,s=void 0===i?{}:i;Object(C.e)(Object(n.a)({page_number:o,page_size:r},s)).then(function(t){var n=t.data;if(1e3===t.code){e=n.equipments||[];var o=n.total_number||0;a.setState({dataList:e,total:o})}else a.setState({dataList:[]}),g.a.error(t.msg||a.props.intl.formatMessage(x.failedToGetData))}).catch(function(e){g.a.error(a.props.intl.formatMessage(x.failedToGetData))}).finally(function(){a.setState({loading:!1})})}},a.doUpdate=function(){var e=a.state.selectedRows,t=a.props.id;e.length?a.state.locked||(a.setState({locked:!0}),function(e,t){return M.b.post(k.update,{equipment_ids:t,version_id:e})}(t,e).then(function(e){1e3===e.code?(g.a.success(a.props.intl.formatMessage(x.updateSuccess)),a.setState({selectedRows:[]})):g.a.error(e.msg||a.props.intl.formatMessage(x.failedToGetData)),a.setState({locked:!1})}).catch(function(e){g.a.error(a.props.intl.formatMessage(x.updateError)),a.setState({locked:!1})})):g.a.warning(a.props.intl.formatMessage(x.selectedRowRequired))},a.handleStandardTableChange=function(e,t,n){var o=a.state,r=o.page_number,i=o.page_size;r=i!==e.pageSize?1:e.current,i=e.pageSize,a.setState({page_number:r,page_size:i},a._loadAsyncData)},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var o=Object(n.a)({},t);a.setState({page_number:1,search_form:o},a._loadAsyncData)}})},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._loadAsyncData();var t=this.getInitAccountIds(),a=this.props.form,n=t.slice(-1)[0];this.setState({search_form:{account_ids:t,account_id:n}}),a.setFieldsValue({account_ids:t,account_id:n},function(){e._loadAsyncData()})}},{key:"componentWillUnmount",value:function(){Object(M.a)()}},{key:"renderSimpleForm",value:function(){var e=this.props.form.getFieldDecorator;return d.a.createElement(m.a,{onSubmit:this.handleSearch,layout:"inline",style:{display:"flex",padding:"5px",alignItems:"flex-end",justifyContent:"space-between"}},d.a.createElement("div",null,3!==(Object(T.a)("userInfo",!0)||{}).role&&d.a.createElement(d.a.Fragment,null,e("account_id")(d.a.createElement(E.a,{type:"hidden"})),d.a.createElement(q,{label:d.a.createElement(h.a,x.sourceAccount)},e("account_ids")(d.a.createElement(S.a,{onChange:this.onAccountChange})))),d.a.createElement(q,{label:d.a.createElement(h.a,x.deviceName)},e("equipment_name")(d.a.createElement(E.a,{maxLength:R.a.deviceName}))),d.a.createElement(q,{label:d.a.createElement(h.a,x.sysVersion)},e("version_name")(d.a.createElement(E.a,{maxLength:R.a.versionName})))),d.a.createElement(O.a,{type:"primary",htmlType:"submit"},d.a.createElement(h.a,x.search)))}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=(e.id,e.title),o=this.state,r=o.selectedRows,i=o.loading,s=o.dataList,c={current:o.page_number,pageSize:o.page_size,showQuickJumper:!0,total:o.total},l={onChange:this.handleSelectRows,selectedRowKeys:r,getCheckboxProps:function(e){return{disabled:e.disabled}}};return d.a.createElement(w.a,{visible:t,title:n,onCancel:a,width:980,footer:null,destroyOnClose:!0},d.a.createElement("div",{className:A.a.tableList},d.a.createElement("div",null,this.renderSimpleForm()),d.a.createElement(_.a,{title:"",buttonText:d.a.createElement(h.a,x.update),buttonType:"default",doAction:this.doUpdate,style:{marginBottom:5,marginTop:20}}),d.a.createElement(j.a,{rowKey:"equipment_id",pagination:c,loading:i,dataSource:s,columns:this.columns,rowSelection:l,scroll:{y:400},onChange:this.handleStandardTableChange})))}}]),t}(d.a.Component),V=Object(h.e)(m.a.create()(F)),P=a(860),z=a(11),U=Object(h.d)({selectFile:{id:"common.selectFile",defaultMessage:"\u9009\u62e9\u6587\u4ef6"}}),K=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e))).onRemove=function(e){a.setState(function(t){var a=t.fileList.indexOf(e),n=t.fileList.slice();return n.splice(a,1),{fileList:n}}),a.triggerChange({file_name:"",file:""})},a.beforeUpload=function(e){return a.setState(function(t){return{fileList:[e]}}),a.triggerChange({file_name:"",file:e}),!1},a.triggerChange=function(e){var t=a.props.onChange;t&&t(Object.assign({},e))};var n=e.value||{};return a.state={file_name:n.file_name,file:n.file,uploading:!1,fileList:n.file_name?[{uid:"1",name:n.file_name,status:"done",url:""}]:[]},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){this.props.isEdit;return d.a.createElement(P.a,{fileList:this.state.fileList,onRemove:this.onRemove,beforeUpload:this.beforeUpload,accept:".apk"},d.a.createElement(O.a,null,d.a.createElement(z.a,{type:"upload"}),d.a.createElement(h.a,U.selectFile)))}}]),t}(u.Component),B=Object(h.e)(K),G=Object(h.d)({versionNumber:{id:"device.versionNumber",defaultMessage:"\u7248\u672c\u53f7"},versionNumberRequired:{id:"device.versionNumber.required",defaultMessage:"\u8bf7\u8f93\u5165\u7248\u672c\u53f7!"},file:{id:"common.file",defaultMessage:"\u6587\u4ef6"},selectFile:{id:"common.selectFile",defaultMessage:"\u9009\u62e9\u6587\u4ef6"},fileRequired:{id:"common.file.required",defaultMessage:"\u8bf7\u9009\u62e9\u6587\u4ef6!"},description:{id:"common.description",defaultMessage:"\u63cf\u8ff0"}}),H=m.a.Item,W=m.a.create()(function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).checkFile=function(e,t,n){!t||t.file||t.file_name?n():n(a.props.intl.formatMessage(G.fileRequired))},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,o=e.form,r=e.formData,i=e.confirmLoading,s=o.getFieldDecorator,c=r||{},l={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},u=!!c.version_id;return d.a.createElement(w.a,{visible:t,title:c.title,onCancel:a,onOk:n,width:360,confirmLoading:i,destroyOnClose:!0},d.a.createElement(m.a,null,s("version_id",{initialValue:c.version_id})(d.a.createElement(E.a,{type:"hidden"})),d.a.createElement(H,Object.assign({},l,{label:d.a.createElement(h.a,G.versionNumber)}),s("version_number",{rules:[{required:!0,message:d.a.createElement(h.a,G.versionNumberRequired)}],initialValue:c.version_number})(d.a.createElement(E.a,{maxLength:R.a.versionNumber}))),d.a.createElement(H,Object.assign({},l,{label:d.a.createElement(h.a,G.file)}),s("version_file",{rules:[{required:!0,message:d.a.createElement(h.a,G.fileRequired)},{validator:this.checkFile}],initialValue:c.version_file})(d.a.createElement(B,{isEdit:u}))),d.a.createElement(H,Object.assign({},l,{label:d.a.createElement(h.a,G.description)}),s("description",{initialValue:c.description})(d.a.createElement(E.a,{maxLength:R.a.description})))))}}]),t}(d.a.Component)),Y=Object(h.e)(W),J=a(720),Q=(m.a.Item,f.a.Option,Object(h.d)({versionList:{id:"device.versionList",defaultMessage:"\u7ec8\u7aef\u7248\u672c\u5217\u8868"},versionNumber:{id:"device.versionNumber",defaultMessage:"\u7248\u672c\u53f7"},fileName:{id:"common.fileName",defaultMessage:"\u6587\u4ef6\u540d"},description:{id:"common.description",defaultMessage:"\u63cf\u8ff0"},uploadTime:{id:"common.uploadTime",defaultMessage:"\u4e0a\u4f20\u65f6\u95f4"},failedToGetData:{id:"common.error.failedToGetData",defaultMessage:"\u83b7\u53d6\u6570\u636e\u5931\u8d25!"},delete:{id:"common.delete",defaultMessage:"\u5220\u9664"},deleteConfirm:{id:"common.delete.confirm",defaultMessage:"\u786e\u5b9a\u5220\u9664\u5417?"},deleteSuccess:{id:"common.delete.success",defaultMessage:"\u5220\u9664\u6210\u529f!"},deleteError:{id:"common.delete.error",defaultMessage:"\u5220\u9664\u5931\u8d25!"},edit:{id:"common.edit",defaultMessage:"\u7f16\u8f91"},operate:{id:"common.operate",defaultMessage:"\u64cd\u4f5c"},add:{id:"common.add",defaultMessage:"\u6dfb\u52a0"},updateDevice:{id:"device.updateDevice",defaultMessage:"\u8bbe\u5907\u66f4\u65b0"},addVersion:{id:"device.addVersion",defaultMessage:"\u7248\u672c\u6dfb\u52a0"},updateVersion:{id:"device.updateVersion",defaultMessage:"\u7248\u672c\u66f4\u65b0"},success:{id:"common.success",defaultMessage:"\u6210\u529f!"},failed:{id:"common.failed",defaultMessage:"\u5931\u8d25\u4e86!"}})),Z=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).columns=[{title:d.a.createElement(h.a,Q.versionNumber),dataIndex:"version_number",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:A.a.wordBreak},e))}},{title:d.a.createElement(h.a,Q.fileName),dataIndex:"file_name",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:A.a.wordBreak},e))}},{title:d.a.createElement(h.a,Q.description),dataIndex:"description",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{className:A.a.wordBreak},e))}},{title:d.a.createElement(h.a,Q.uploadTime),dataIndex:"upload_time",render:function(e,t){return d.a.createElement(d.a.Fragment,null,Object(J.j)(e))}},{title:d.a.createElement(h.a,Q.operate),dataIndex:"operate",render:function(e,t){return d.a.createElement(d.a.Fragment,null,d.a.createElement("a",{href:"javascript:;",onClick:function(){a.showUpdateModal(t.version_id)},className:A.a.operatorLink},d.a.createElement(h.a,Q.updateDevice)),d.a.createElement("a",{href:"javascript:;",onClick:function(){return a.showEditModal(t.version_id)},className:A.a.operatorLink},d.a.createElement(h.a,Q.edit)),d.a.createElement(p.a,{className:A.a.operatorLink,title:d.a.createElement(h.a,Q.deleteConfirm),onConfirm:function(){return a.onDelete(t.version_id)}},d.a.createElement("a",{href:"javascript:;"},d.a.createElement(h.a,Q.delete))))}}],a.queryStrings=a.props.location.query||{},a.state={selectedRows:[],loading:!1,confirmLoading:!1,locked:!1,visible:!1,isUpdateVisible:!1,acountOptions:[],versionList:[],formData:{},search_form:{},uuid:Date.now(),updateKey:Object(J.g)(),operateId:"",total:0,page_number:1,page_size:J.c,batchDeleteMode:!1},a.showModal=function(){var e={title:d.a.createElement(h.a,Q.updateDevice)};a.setState({visible:!0,formData:e})},a.showUpdateModal=function(e){a.setState({isUpdateVisible:!0,operateId:e,updateKey:Object(J.g)()})},a.showEditModal=function(e){a.state.locked||(a.setState({locked:!0}),function(e){return M.b.get(k.version,{params:{version_id:e}})}(e).then(function(e){if(1e3===e.code){var t=e.data,n=t.version_id,o=t.file_name,r=t.description,i=t.version_number,s={title:d.a.createElement(h.a,Q.updateVersion),version_id:n,version_file:{file_name:o},description:r,version_number:i};a.setState({visible:!0,formData:s})}else g.a.error(e.msg||a.props.intl.formatMessage(Q.failedToGetData));a.setState({locked:!1})}).catch(function(e){g.a.error(a.props.intl.formatMessage(Q.failedToGetData)),console.log(e),a.setState({locked:!1})}))},a.handleModal=function(e,t){a.setState(Object(o.a)({},e,t))},a.handleStandardTableChange=function(e,t,n){var o=a.state,r=o.page_number,i=o.page_size;r=i!==e.pageSize?1:e.current,i=e.pageSize,a.setState({page_number:r,page_size:i},a._loadAsyncData)},a.onDelete=function(e){(function(e){return M.b.delete(k.version,{data:{version_id:e}})})(e).then(function(e){1e3===e.code?(g.a.success(a.props.intl.formatMessage(Q.deleteSuccess)),a._loadAsyncData()):g.a.error(e.msg||a.props.intl.formatMessage(Q.deleteError))}).catch(function(e){g.a.error(a.props.intl.formatMessage(Q.deleteError)),console.log(e)})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.saveFormRef=function(e){a.formRef=e},a.handleCancel=function(){a.setState({visible:!1,uuid:Date.now()})},a.handleCreate=function(){var e=a.formRef.props.form;e.validateFields(function(t,n){if(!t){var o=n.version_id,r=n.version_number,i=n.version_file,s=void 0===i?{}:i,c=n.description,l=Object(J.d)({version_id:o,version_number:r,version_file:s.file,description:c}),u=D,d=a.props.intl.formatMessage(Q.addVersion),m=a.props.intl.formatMessage(Q.success),f=a.props.intl.formatMessage(Q.failed);l.version_id&&(u=L,d=a.props.intl.formatMessage(Q.updateVersion)),a.setState({confirmLoading:!0}),u(l).then(function(t){1e3===t.code?(g.a.success("".concat(d).concat(m)),a._loadAsyncData(),e.resetFields(),a.setState({visible:!1})):g.a.error(t.msg||"".concat(d).concat(f)),a.setState({confirmLoading:!1})}).catch(function(e){a.setState({confirmLoading:!1}),g.a.error("".concat(d).concat(f)),console.log(e)})}})},a}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._loadAsyncData()}},{key:"componentWillUnmount",value:function(){Object(M.a)()}},{key:"_loadAsyncData",value:function(){var e=this;this.setState({loading:!0});var t,a=this.state,o=a.page_number,r=a.page_size,i=a.search_form,s=void 0===i?{}:i,c=[];(t=Object(n.a)({page_number:o,page_size:r},s),M.b.get(k.list,{params:Object(n.a)({},t)})).then(function(t){var a=t.data;if(1e3===t.code){c=a.versionList||[];var n=a.total_number||0;e.setState({versionList:c,total:n,selectedRows:[]})}else e.setState({versionList:[],selectedRows:[]}),g.a.error(t.msg||e.props.intl.formatMessage(Q.failedToGetData))}).catch(function(e){console.log(e)}).finally(function(){e.setState({loading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.selectedRows,o=t.versionList,r=t.total,i=t.page_number,s=t.page_size,c=t.visible,l=t.formData,u=t.confirmLoading,m=t.uuid,f={current:i,pageSize:s,total:r};return d.a.createElement(d.a.Fragment,null,d.a.createElement(b.a,{bordered:!1},d.a.createElement("div",{className:A.a.tableList},d.a.createElement(_.a,{title:d.a.createElement(h.a,Q.versionList),buttonText:d.a.createElement(h.a,Q.add),doAction:this.showModal,style:{marginBottom:5}}),d.a.createElement(v.a,{rowKey:"version_id",selectedRows:n,selectable:!1,pagination:f,loading:a,showAlert:!1,dataList:o,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}),d.a.createElement(Y,{wrappedComponentRef:this.saveFormRef,visible:c,onCancel:this.handleCancel,onCreate:this.handleCreate,formData:l,key:m,confirmLoading:u}),d.a.createElement(V,{visible:this.state.isUpdateVisible,key:this.state.updateKey,onCancel:function(){return e.handleModal("isUpdateVisible",!1)},id:this.state.operateId,title:this.props.intl.formatMessage(Q.updateDevice)}))))}}]),t}(d.a.Component);t.default=Object(h.e)(m.a.create()(Z))}}]);
//# sourceMappingURL=11.1684bdc9.chunk.js.map